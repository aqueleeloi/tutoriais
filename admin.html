<!DOCTYPE html>
<html lang="pt-pt">
<head>
    <meta charset="UTF-8">
    <title>Admin - Gestor</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Poppins', sans-serif; background: #222; color: white; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; background: #333; padding: 30px; border-radius: 10px; }
        input, select { width: 100%; padding: 12px; margin: 5px 0 15px; background: #444; border: 1px solid #555; color: white; border-radius: 5px; outline:none;}
        .btn { padding: 12px; width: 100%; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; margin-bottom: 10px; }
        .save { background: #00d26a; color: #fff; }
        .download { background: #31A8FF; color: white; margin-top: 20px; }
        .item { background: #444; padding: 12px; margin-bottom: 5px; display: flex; justify-content: space-between; align-items: center; border-radius: 4px; }
        .del { background: #ff4757; color: white; border: none; padding: 5px 10px; cursor: pointer; }
    </style>
</head>
<body>

<div class="container">
    <h2 style="text-align:center; color:#00d26a">Adicionar Conteúdo</h2>
    
    <label>Plataforma</label>
    <select id="platform">
        <option value="ps">Photoshop</option>
        <option value="pp">Photopea</option>
    </select>

    <label>Link (YouTube OU Site de Artigo/PDF)</label>
    <input type="text" id="url" placeholder="Cola o URL aqui...">

    <label>Título</label>
    <input type="text" id="title" placeholder="Título...">

    <label>Descrição</label>
    <input type="text" id="desc" placeholder="Breve descrição...">

    <label>Categoria</label>
    <select id="tag">
        <option value="CRIACAO">1. Criação / Config</option>
        <option value="FERRAMENTAS">2. Ferramentas</option>
        <option value="RECORTE">3. Recorte Básico</option>
        <option value="MASCARAS">4. Máscaras / Avançado</option>
        <option value="EXTRA">5. Extra / Documentos</option>
    </select>

    <button class="btn save" onclick="addVideo()">Adicionar</button>

    <div style="margin-top:30px; border-top:1px solid #555; padding-top:10px;">
        <h3>Lista Atual (<span id="count">0</span>)</h3>
        <div id="list"></div>
    </div>

    <button class="btn download" onclick="downloadFile()">SALVAR MUDANÇAS (Baixar videos.js)</button>
</div>

<script src="videos.js"></script>
<script>
    let videos = (typeof tutorialData !== 'undefined') ? tutorialData : [];

    function render() {
        const list = document.getElementById('list');
        document.getElementById('count').innerText = videos.length;
        list.innerHTML = '';

        videos.forEach((v, i) => {
            // Visual simples para diferenciar Vídeo de Doc no admin
            let typeIcon = v.id.startsWith('http') ? '<i class="fas fa-book"></i>' : '<i class="fab fa-youtube"></i>';
            
            list.innerHTML += `
                <div class="item">
                    <div>
                        <span style="color:#bbb; margin-right:5px;">${typeIcon}</span>
                        <strong>${v.title}</strong>
                        <span style="font-size:0.8rem; background:#666; padding:2px 5px; border-radius:3px; margin-left:5px;">${v.tag}</span>
                    </div>
                    <button class="del" onclick="remove(${i})"><i class="fas fa-trash"></i></button>
                </div>`;
        });
    }

    function addVideo() {
        const url = document.getElementById('url').value;
        const title = document.getElementById('title').value;
        
        if (!url || !title) { alert("Link e Título são obrigatórios!"); return; }

        let finalId;
        // Lógica: Se for Youtube, extrai ID. Se não, guarda o link todo (Doc).
        if (url.includes('youtube.com') || url.includes('youtu.be')) {
            const idMatch = url.match(/(?:v=|\/)([\w-]{11})/);
            if(idMatch) finalId = idMatch[1];
            else { alert("Link Youtube inválido"); return; }
        } else {
            // É um documento/site
            finalId = url;
        }

        videos.push({
            id: finalId,
            title: title,
            desc: document.getElementById('desc').value,
            platform: document.getElementById('platform').value,
            tag: document.getElementById('tag').value
        });

        // Limpar
        document.getElementById('url').value = '';
        document.getElementById('title').value = '';
        document.getElementById('desc').value = '';
        render();
    }

    function remove(index) {
        if(confirm("Apagar?")) { videos.splice(index, 1); render(); }
    }

    function downloadFile() {
        const content = "const tutorialData = " + JSON.stringify(videos, null, 2) + ";";
        const blob = new Blob([content], {type: "text/javascript"});
        const link = document.createElement("a");
        link.href = URL.createObjectURL(blob);
        link.download = "videos.js"; 
        link.click();
    }
    render();
</script>
</body>
</html>
