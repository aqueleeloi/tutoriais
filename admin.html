<!DOCTYPE html>
<html lang="pt-pt">
<head>
    <meta charset="UTF-8">
    <title>Admin - Gestor de Vídeos</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Poppins', sans-serif; background: #222; color: white; padding: 20px; }
        .container { max-width: 800px; margin: 0 auto; background: #333; padding: 20px; border-radius: 10px; }
        input, select { width: 100%; padding: 10px; margin: 5px 0 15px; background: #444; border: 1px solid #555; color: white; border-radius: 5px; }
        .btn { padding: 12px; width: 100%; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; font-size: 1rem; margin-bottom: 10px; }
        .save { background: #00d26a; color: white; }
        .download { background: #00a8ff; color: white; margin-top: 20px; padding: 20px; font-size: 1.2rem; }
        .item { background: #444; padding: 10px; margin-bottom: 5px; display: flex; justify-content: space-between; align-items: center; border-radius: 5px; }
        .del { background: #ff4757; color: white; border: none; padding: 5px 10px; cursor: pointer; border-radius: 3px; }
    </style>
</head>
<body>

<div class="container">
    <h2 style="text-align:center">Adicionar Novo Vídeo</h2>
    
    <label>Plataforma</label>
    <select id="platform">
        <option value="ps">Photoshop</option>
        <option value="pp">Photopea</option>
    </select>

    <label>Link YouTube</label>
    <input type="text" id="url" placeholder="Cola o link aqui...">

    <label>Título</label>
    <input type="text" id="title" placeholder="Título da aula...">

    <label>Descrição</label>
    <input type="text" id="desc" placeholder="Pequena descrição...">

    <label>Etiqueta</label>
    <select id="tag">
        <option value="INTRO">Intro</option>
        <option value="RECORTE">Recorte</option>
        <option value="PINCEL">Pincel</option>
        <option value="CONFIG">Config</option>
    </select>

    <button class="btn save" onclick="addVideo()">Adicionar à Lista</button>

    <h3 style="margin-top:30px; border-top:1px solid #555; padding-top:20px;">Lista Atual de Vídeos</h3>
    <div id="list"></div>

    <button class="btn download" onclick="downloadFile()">
        <i class="fas fa-save"></i> SALVAR ALTERAÇÕES (Baixar videos.js)
    </button>
    <p style="text-align:center; color:#bbb; font-size:0.9rem;">Ao clicar, substitui o ficheiro 'videos.js' na pasta.</p>
</div>

<script src="videos.js"></script>

<script>
    // Se não houver ficheiro, inicia array vazio
    let videos = (typeof tutorialData !== 'undefined') ? tutorialData : [];

    function render() {
        const list = document.getElementById('list');
        list.innerHTML = '';
        videos.forEach((v, i) => {
            list.innerHTML += `
                <div class="item">
                    <div>
                        <strong style="color:${v.platform === 'ps' ? '#00a8ff' : '#00d26a'}">[${v.platform.toUpperCase()}]</strong> 
                        ${v.title}
                    </div>
                    <button class="del" onclick="remove(${i})"><i class="fas fa-trash"></i></button>
                </div>`;
        });
    }

    function addVideo() {
        const url = document.getElementById('url').value;
        const idMatch = url.match(/(?:v=|\/)([\w-]{11})/);
        
        if (!idMatch || !document.getElementById('title').value) {
            alert("Preenche o título e um link válido do YouTube!");
            return;
        }

        videos.push({
            id: idMatch[1],
            title: document.getElementById('title').value,
            desc: document.getElementById('desc').value,
            platform: document.getElementById('platform').value,
            tag: document.getElementById('tag').value
        });

        // Limpar campos
        document.getElementById('url').value = '';
        document.getElementById('title').value = '';
        document.getElementById('desc').value = '';
        render();
    }

    function remove(index) {
        if(confirm("Apagar este vídeo?")) {
            videos.splice(index, 1);
            render();
        }
    }

    function downloadFile() {
        // A MAGIA: Cria o ficheiro JS dinamicamente
        const content = "const tutorialData = " + JSON.stringify(videos, null, 2) + ";";
        const blob = new Blob([content], {type: "text/javascript"});
        const link = document.createElement("a");
        
        link.href = URL.createObjectURL(blob);
        link.download = "videos.js"; // Nome do ficheiro a baixar
        link.click();
        
        alert("Ficheiro baixado! Agora arrasta-o para a pasta onde está o index.html e substitui o antigo.");
    }

    render();
</script>

</body>
</html>
