<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <title>Painel Admin - Atualizar V√≠deos</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f4f4f9; }
        .container { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        textarea { width: 100%; height: 200px; margin: 10px 0; font-family: monospace; }
        button { background: #2ea44f; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; }
        button:disabled { background: #ccc; }
    </style>
</head>
<body>

<div class="container">
    <h2>üé¨ Atualizar videos.js</h2>
    <p>Insere o novo c√≥digo JS abaixo:</p>
    <textarea id="codigoJs" placeholder="const videos = [...]"></textarea>
    <br>
    <button id="btnGravar" onclick="atualizarGithub()">Gravar no GitHub üöÄ</button>
    <p id="status"></p>
</div>

<script>
    // CONFIGURA√á√ÉO - PREENCHE AQUI:
    const TOKEN = 'O_TEU_TOKEN_AQUI'; // CUIDADO: Em sites p√∫blicos, isto √© arriscado!
    const REPO = 'aqueleeloi/tutoriais';
    const PATH = 'videos.js';

    async function atualizarGithub() {
        const conteudo = document.getElementById('codigoJs').value;
        const status = document.getElementById('status');
        const btn = document.getElementById('btnGravar');
        
        status.innerText = "A ligar ao GitHub...";
        btn.disabled = true;

        try {
            // 1. Obter o "sha" do ficheiro atual (necess√°rio para o GitHub aceitar o update)
            const res = await fetch(`https://api.github.com/repos/${REPO}/contents/${PATH}`);
            const data = await res.json();
            const sha = data.sha;

            // 2. Enviar o novo conte√∫do
            const updateRes = await fetch(`https://api.github.com/repos/${REPO}/contents/${PATH}`, {
                method: 'PUT',
                headers: {
                    'Authorization': `token ${TOKEN}`,
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    message: "Atualiza√ß√£o autom√°tica via Admin ü§ñ",
                    content: btoa(unescape(encodeURIComponent(conteudo))), // Converte para Base64
                    sha: sha
                })
            });

            if (updateRes.ok) {
                status.innerText = "‚úÖ Gravado com sucesso! O site vai atualizar em 1 min.";
                status.style.color = "green";
            } else {
                throw new Error("Erro ao gravar");
            }
        } catch (err) {
            status.innerText = "‚ùå Erro: " + err.message;
            status.style.color = "red";
        } finally {
            btn.disabled = false;
        }
    }
</script>

</body>
</html>
